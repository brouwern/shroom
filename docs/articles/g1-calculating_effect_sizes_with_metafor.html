<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
<ol start="7" style="list-style-type: lower-alpha">
<li>Calculating effect sizes using the metafor package</li>
</ol> • shroom</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="&lt;ol start=" style="list-style-type: lower-alpha">
</head>
<body>
<li>Calculating effect sizes using the metafor package</li>
" /&gt;

<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">shroom</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/a1-introduction.html">a1) Introduction to the shroom package</a>
    </li>
    <li>
      <a href="../articles/a2-intro_to_ind_project_questions.html">a2) Introduction to shroom</a>
    </li>
    <li>
      <a href="../articles/b-loading_the_shroom_package.html">b) Loading the shroom package</a>
    </li>
    <li>
      <a href="../articles/c-subsetting_a_dataframe_with_dplyr.html">c) Subsetting a dataframe with dplyr</a>
    </li>
    <li>
      <a href="../articles/d-summarizing_data_with_dplyr.html">d) Summarizing data with dplyr</a>
    </li>
    <li>
      <a href="../articles/f1-analysis_walkthrough_t_test_and_friends.html">f) Analysis walthrough: t-test and friends</a>
    </li>
    <li>
      <a href="../articles/f3-analysis_walkthrough_2-way_ANOVA.html">f3) Analysis walthrough: 2-way factorial ANOVA</a>
    </li>
    <li>
      <a href="../articles/f4-analysis_walkthrough_nested_ANOVA.html">f4) Analysis walthrough: Nested ANOVA</a>
    </li>
    <li>
      <a href="../articles/g1-calculating_effect_sizes_with_metafor.html">g) Calculating effect sizes using the metafor package</a>
    </li>
    <li>
      <a href="../articles/g2-analysis_of_difference_scores.html">f) Analysis of difference scores: thinking about effect sizes, sample sizes &amp; effect size variances</a>
    </li>
    <li>
      <a href="../articles/s1-stub-probablistic_index_models.html">s1) Stub - Probablistic index models</a>
    </li>
    <li>
      <a href="../articles/y-creating_a_package.html">w) Creating this package</a>
    </li>
    <li>
      <a href="../articles/z-build_and_rebuild_package.html">z) Building and rebuilding vignettes</a>
    </li>
    <li>
      <a href="../articles/z2-building_a_package.html">z2) Building and rebuilding vignettes - orig</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1><ol start="7" style="list-style-type: lower-alpha">
<li>Calculating effect sizes using the metafor package</li>
</ol></h1>
                        <h4 class="author">Nathan Brouwer</h4>
            
            <h4 class="date">2018-12-11</h4>
      
      
      <div class="hidden name"><code>g1-calculating_effect_sizes_with_metafor.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>In order to do a <strong>meta-analysis</strong> or meta-analysis type work up of a data set we need to calculate <strong>effect sizes</strong>. The <strong>metafor</strong> package (<a href="https://www.jstatsoft.org/article/view/v036i03">Viechtbauer 2010</a>) is probably the most popular R package for meta-analysis among biologist and can be used to calculate effect sizes, as well a carry out meta analyses.</p>
<p>Effect sizes are usually based on 2 quantities</p>
<ol style="list-style-type: decimal">
<li>The mean of 2 groups, such as control and experimentally treated organisms.</li>
<li>The standard deviation (SD) of the 2 groups.</li>
</ol>
<p>The means and SDs of each group for a single study are then converted into an effects size, such as <strong>Cohen’s d</strong> or a <strong>response ratio</strong>, which summarizes the difference between the 2 treatments. Effect sizes can be useful for presenting the results for a single study in a currency that can be compared to other studies, and effect sizes from multiple studies can be combined into a meta-analysis.</p>
<p>In this tutorial we’ll calculate the necessary summary statistics using dplyr, and then effect sizes using metafor. We’ll calculate effect sizes for each of the 18 alleles investigated by a single section of the Neuro Defects lab.</p>
</div>
<div id="preliminaries" class="section level2">
<h2 class="hasAnchor">
<a href="#preliminaries" class="anchor"></a>Preliminaries</h2>
<div id="load-packages" class="section level3">
<h3 class="hasAnchor">
<a href="#load-packages" class="anchor"></a>Load packages</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(shroom)
<span class="kw">library</span>(metafor)
<span class="co">#&gt; Loading required package: Matrix</span>
<span class="co">#&gt; Loading 'metafor' package (version 2.0-0). For an overview </span>
<span class="co">#&gt; and introduction to the package please type: help(metafor).</span>

<span class="kw">library</span>(dplyr)
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'dplyr'</span>
<span class="co">#&gt; The following objects are masked from 'package:stats':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     filter, lag</span>
<span class="co">#&gt; The following objects are masked from 'package:base':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     intersect, setdiff, setequal, union</span>
<span class="kw">library</span>(tidyr)
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'tidyr'</span>
<span class="co">#&gt; The following object is masked from 'package:Matrix':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     expand</span>
<span class="kw">library</span>(data.table)
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'data.table'</span>
<span class="co">#&gt; The following objects are masked from 'package:dplyr':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     between, first, last</span></code></pre></div>
</div>
<div id="load-shroom-data" class="section level3">
<h3 class="hasAnchor">
<a href="#load-shroom-data" class="anchor"></a>Load shroom data</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(<span class="st">"wngscrs_sxn1"</span>)</code></pre></div>
<p>This is a somewhat large set of data</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dim</span>(wngscrs_sxn1)
<span class="co">#&gt; [1] 624  15</span></code></pre></div>
<p>We can get a glimpse of the data using the table() command</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">with</span>(wngscrs_sxn1, 
     <span class="kw">table</span>(gene.allele, 
           gene.shrt))
<span class="co">#&gt;            gene.shrt</span>
<span class="co">#&gt; gene.allele abl dia fhos ssh trio twn</span>
<span class="co">#&gt;      abl.1   60   0    0   0    0   0</span>
<span class="co">#&gt;      abl.2   53   0    0   0    0   0</span>
<span class="co">#&gt;      abl.3   46   0    0   0    0   0</span>
<span class="co">#&gt;      dia.1    0  16    0   0    0   0</span>
<span class="co">#&gt;      dia.2    0  29    0   0    0   0</span>
<span class="co">#&gt;      dia.3    0  27    0   0    0   0</span>
<span class="co">#&gt;      fhos.1   0   0   38   0    0   0</span>
<span class="co">#&gt;      fhos.2   0   0   43   0    0   0</span>
<span class="co">#&gt;      fhos.3   0   0   34   0    0   0</span>
<span class="co">#&gt;      ssh.1    0   0    0  32    0   0</span>
<span class="co">#&gt;      ssh.2    0   0    0  66    0   0</span>
<span class="co">#&gt;      ssh.3    0   0    0  33    0   0</span>
<span class="co">#&gt;      trio.1   0   0    0   0   11   0</span>
<span class="co">#&gt;      trio.2   0   0    0   0   15   0</span>
<span class="co">#&gt;      trio.3   0   0    0   0   41   0</span>
<span class="co">#&gt;      twn.1    0   0    0   0    0  19</span>
<span class="co">#&gt;      twn.2    0   0    0   0    0  22</span>
<span class="co">#&gt;      twn.3    0   0    0   0    0  39</span></code></pre></div>
</div>
</div>
<div id="summarizing-data-by-group" class="section level2">
<h2 class="hasAnchor">
<a href="#summarizing-data-by-group" class="anchor"></a>Summarizing data by group</h2>
<p>To use metafor to calculate effect sizes, you must first have means and SDs. For a single study, you might have single effect size summarize the difference between experimental and control treatments. When you are doing a meta analysis, you work up an effect size for each experiment; usually you extract summary stats from the published paper. In contrast, we are working with raw data from a multi-layered study, and we’ll be treating data from each student like a mini-study and then compare effect sizes across students within the same lab section like a meta-analysis.</p>
<p>Summary stats for our raw fly wing data can easily be worked up with dplyr’s group_by() and summarize() commands. In the following code we’ll summarize data for the 18 alleles in this lab section. We pass 3 things to group_by: the experimental group (E or C), the allele designation (“gene.allele”) and the allele name (“allele”). “gene.allele” and “allele” contain redundant information; “allele” is the precise name of the mutated gene (eg “abl[2]”) while “gene.allele” is just the name of the gene and a numeric code (1, 2 or 3) indicating the order which the alleles are organized in the dataset. This will help use with organization later.</p>
<p>We also include “student.ID” to further distinguish the seperate datasets (each student works on a single allele).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sxn1_summary &lt;-<span class="st"> </span>wngscrs_sxn1 <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(E.or.C,
           gene.allele,
           allele, 
           student.ID) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarize</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(wing.score),
            <span class="dt">sd =</span> <span class="kw">sd</span>(wing.score),
            <span class="dt">n =</span> <span class="kw">n</span>())</code></pre></div>
<p>We can look at the output; note that because dplyr creates “tibble” objects R only prints out a selection of columns.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sxn1_summary
<span class="co">#&gt; # A tibble: 36 x 7</span>
<span class="co">#&gt; # Groups:   E.or.C, gene.allele, allele [?]</span>
<span class="co">#&gt;    E.or.C gene.allele allele          student.ID  mean      sd     n</span>
<span class="co">#&gt;    &lt;fct&gt;  &lt;fct&gt;       &lt;fct&gt;                &lt;int&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;int&gt;</span>
<span class="co">#&gt;  1 C      abl.1       abl[2]                   1  4.64   0.742    33</span>
<span class="co">#&gt;  2 C      abl.2       abl[04674]               2  3.91   1.44     35</span>
<span class="co">#&gt;  3 C      abl.3       Df(3L)ED223              3  4.56   1.58     27</span>
<span class="co">#&gt;  4 C      dia.1       dia[2]                  10  3    NaN         1</span>
<span class="co">#&gt;  5 C      dia.2       dia[5]                  11  3.88   1.02     16</span>
<span class="co">#&gt;  6 C      dia.3       Df(2L)ED1317            12  6.17   1.17      6</span>
<span class="co">#&gt;  7 C      fhos.1      Fhos[01629]              7  5.64   0.505    11</span>
<span class="co">#&gt;  8 C      fhos.2      Df(3L)ED4413             8  4.62   1.15     16</span>
<span class="co">#&gt;  9 C      fhos.3      Df(3L)ED4414             9  5      1        19</span>
<span class="co">#&gt; 10 C      ssh.1       slingshot[1-11]         16  5.92   1.16     12</span>
<span class="co">#&gt; # ... with 26 more rows</span></code></pre></div>
</div>
<div id="calculate-effect-sizes" class="section level2">
<h2 class="hasAnchor">
<a href="#calculate-effect-sizes" class="anchor"></a>Calculate effect sizes</h2>
<p>metafor has a function, <strong>escalc()</strong>, which returns an effect size when given a mean and standard deviation. The form that you give data to escalc() depends on how you worked up the data.</p>
<p>We’ll first examine a simple case of calculating 1 effect size, then work up all of our data.</p>
<div id="effect-size-walk-through" class="section level3">
<h3 class="hasAnchor">
<a href="#effect-size-walk-through" class="anchor"></a>Effect size walk through</h3>
<p>Let’s first look at a simple case: an effect size for a single allele. I’ll find the control and experimental results for the abl[2] allele, which is the 1st of 3 able alleles and so is also referred to as “abl.1”.</p>
<p>1st I’ll find the indices of the 2 desired rows of data. This requires the which() command. This code asks “which rows in the gene.allele column of the sxn1_summary dataframe contain the string ‘abl.1’.” (I could also use the dplyr filter command here too)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">i.able.<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">which</span>(sxn1_summary<span class="op">$</span>gene.allele <span class="op">==</span><span class="st"> "abl.1"</span>)</code></pre></div>
<p>I can pull out using that index using square brackets.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">abl.<span class="dv">1</span> &lt;-<span class="st"> </span>sxn1_summary[i.able.<span class="dv">1</span>, ]</code></pre></div>
<p>So I know have a 2-row summary table of just abl.1 for the control (C) and experimental (E) groups.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">abl.<span class="dv">1</span>
<span class="co">#&gt; # A tibble: 2 x 7</span>
<span class="co">#&gt; # Groups:   E.or.C, gene.allele, allele [2]</span>
<span class="co">#&gt;   E.or.C gene.allele allele student.ID  mean    sd     n</span>
<span class="co">#&gt;   &lt;fct&gt;  &lt;fct&gt;       &lt;fct&gt;       &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;</span>
<span class="co">#&gt; 1 C      abl.1       abl[2]          1  4.64 0.742    33</span>
<span class="co">#&gt; 2 E      abl.1       abl[2]          1  4.70 1.07     27</span></code></pre></div>
<p>A Cohen’s d effect size for the impact of the experimental treatment on fly wing phenotype would be calculated as:</p>
<p>(mean.1 - mean.2)/(“pooled” SD)</p>
<p>where the <strong>pooled SD</strong> is a <strong>weighted average</strong> the the 2 standard deviations.</p>
<p>metafor’s escalc() function luckily calculates the pooled SD for us, so we just have to give it the 2 means, the 2 SDs, and 2 two sample sizes.</p>
<p>I can isolate the means from the abl.1 summary table like this using square brackets [ ]</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#1st row </span>
mean.C &lt;-<span class="st"> </span>abl.<span class="dv">1</span><span class="op">$</span>mean[<span class="dv">1</span>]

<span class="co">#2nd row</span>
mean.E &lt;-<span class="st"> </span>abl.<span class="dv">1</span><span class="op">$</span>mean[<span class="dv">2</span>]</code></pre></div>
<p>And similarly the SDs and Ns like this</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># standard deviations</span>
sd.C &lt;-<span class="st"> </span>abl.<span class="dv">1</span><span class="op">$</span>sd[<span class="dv">1</span>]
sd.E &lt;-<span class="st"> </span>abl.<span class="dv">1</span><span class="op">$</span>sd[<span class="dv">2</span>]

<span class="co">#sampel sizes</span>
n.C &lt;-<span class="st"> </span>abl.<span class="dv">1</span><span class="op">$</span>n[<span class="dv">1</span>]
n.E &lt;-<span class="st"> </span>abl.<span class="dv">1</span><span class="op">$</span>n[<span class="dv">2</span>]</code></pre></div>
<p>I can then pass this information to escalc(). I also have to specify a “measure”, which is the name of an particular flavor of effect size. I’ll ask for the <strong>“SMD”</strong>, which is the <strong>“standardized mean difference”</strong>, which is a more generic name for Cohen’s d (actually an updated version called <strong>Hedge’s g</strong>).</p>
<p>escalc has some somewhat cryptic arguments</p>
<ul>
<li>means: m1i and m2i</li>
<li>SDs: sd1i and sd2i</li>
<li>sample size (n): n1i and n2i</li>
<li>effect size: measure</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">metafor<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/metafor/topics/escalc">escalc</a></span>(<span class="dt">m1i =</span> mean.C, <span class="dt">m2i =</span> mean.E, 
                <span class="dt">sd1i =</span> sd.C, <span class="dt">sd2i =</span> sd.E,
                <span class="dt">n1i =</span> n.C, <span class="dt">n2i =</span> n.E,
                <span class="dt">measure =</span> <span class="st">"SMD"</span>)
<span class="co">#&gt;        yi     vi</span>
<span class="co">#&gt; 1 -0.0736 0.0674</span></code></pre></div>
<p>esclac() returns 2 things: “yi” and “vi”. yi is the effect size, and vi is the <strong>variance</strong> for the effects size. This variance value is used indicate how precisely the effect size was estimate, allowing calculation of standard errors and confidence intervals for a single effect size, and indicating how much influence (“weight”) a single effect size should have on a meta-analysis..</p>
<p>There are <em>many</em> flavors of effect sizes. One popular in ecology is the <strong>“log response ratio”</strong> (<a href="https://esajournals.onlinelibrary.wiley.com/doi/full/10.1890/0012-9658%281999%29080%5B1150%3ATMAORR%5D2.0.CO%3B2">Hedges et al 1999</a>), which is calculated as</p>
<p>log response ratio = log(mean.1/mean.2).</p>
<p>To get it, we use measure = “ROM”, where ROM = <strong>“ratio of means”</strong> (the log is implied). As best I can tell, the ROM was first used in ecology and independently was developed in medicine.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">metafor<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/metafor/topics/escalc">escalc</a></span>(<span class="dt">m1i =</span> mean.C, <span class="dt">m2i =</span> mean.E, 
                <span class="dt">sd1i =</span> sd.C, <span class="dt">sd2i =</span> sd.E,
                <span class="dt">n1i =</span> n.C, <span class="dt">n2i =</span> n.E,
                <span class="dt">measure =</span> <span class="st">"ROM"</span>)
<span class="co">#&gt;        yi     vi</span>
<span class="co">#&gt; 1 -0.0144 0.0027</span></code></pre></div>
<p>We can check escalc’s math if we want. The ratio of our means is just</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mean.C<span class="op">/</span>mean.E
<span class="co">#&gt; [1] 0.9856836</span></code></pre></div>
<p>And the log of the ratio is</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">log</span>(mean.C<span class="op">/</span>mean.E)
<span class="co">#&gt; [1] -0.01441986</span></code></pre></div>
<p>Due to the unique properties of how data work, the variance (vi) for a difference between 2 means (aka standardized difference between means, MSD) is calculated using a weighted average, while the variance for a ratio of 2 means (ROM) has a very different formula.</p>
</div>
</div>
<div id="multiple-effect-sizes-escalc-formula-notation" class="section level2">
<h2 class="hasAnchor">
<a href="#multiple-effect-sizes-escalc-formula-notation" class="anchor"></a>Multiple effect sizes: escalc formula notation</h2>
<p>escalc() can also work with a <strong>formula notation</strong> similar to how the lm() function works. The notation is a bit complex though. This notation is very useful for when you have data summarized in “long” format from dplyr, so its worth the effort to see how it works.</p>
<p>escalc’s formula notation has these features:</p>
<ul>
<li>Left-hand side of formula: “mean/sd” for the effect size</li>
<li>Right-hand side of formula: “~ grouping.var | study.var”, where “grouping.var” is a categorical variable that distinguishes the 2 treatments within a study or experiment, and “| study.var” is a categorical variable that distinguishes between different studies, experiments, or datasets.
<ul>
<li>In our data, the grouping variable is “E.or.C”, for the Experimental or Control treatment, and the study variable is “student.ID”, which distinguishes the seperate datasets generated by each students, which we are treating like unique experiments for our quasi-meta analysis.</li>
</ul>
</li>
<li>The sample size is indicated by “weights = n”</li>
<li>The dataset being used, set by “data = …”</li>
<li>The effect size to be used, set by “measure = …”</li>
</ul>
<p>“student.ID” is a numeric variable. In the code below we wrap it in factor() to convert it to a categorical variable. We could also set it to a factor in the dataframe like this</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sxn1_summary<span class="op">$</span>student.ID &lt;-<span class="st"> </span><span class="kw">factor</span>(sxn1_summary<span class="op">$</span>student.ID)</code></pre></div>
<div id="escalc-formula-notation-demonstration" class="section level3">
<h3 class="hasAnchor">
<a href="#escalc-formula-notation-demonstration" class="anchor"></a>escalc formula notation demonstration</h3>
<p>Let’s re-calculate the effect size for the 1st <em>able</em> allele. Note that for the dataset I am using the summary dataset we made of just the able 1 allele, which has only 2 rows</p>
<pre><code>#&gt; # A tibble: 2 x 7
#&gt; # Groups:   E.or.C, gene.allele, allele [2]
#&gt;   E.or.C gene.allele allele student.ID  mean    sd     n
#&gt;   &lt;fct&gt;  &lt;fct&gt;       &lt;fct&gt;       &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;
#&gt; 1 C      abl.1       abl[2]          1  4.64 0.742    33
#&gt; 2 E      abl.1       abl[2]          1  4.70 1.07     27</code></pre>
<p>Now let’s get our effect size using formula notation. Again, on the left side of the equation is mean/sd, and the right side is a funky notation using a vertical bar. We also give it weights, the effect size measure and the data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">escalc</span>(mean<span class="op">/</span>sd <span class="op">~</span><span class="st"> </span>E.or.C <span class="op">|</span><span class="st"> </span><span class="kw">factor</span>(student.ID),
       <span class="dt">weights =</span> n,
       <span class="dt">measure =</span> <span class="st">"SMD"</span>, 
       <span class="dt">data =</span> abl.<span class="dv">1</span>)
<span class="co">#&gt;        yi     vi</span>
<span class="co">#&gt; 1 -0.0736 0.0674</span></code></pre></div>
<p>This should be the same result as our previous way of using escalc()</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">escalc</span>(<span class="dt">m1i =</span> mean.C, <span class="dt">m2i =</span> mean.E, 
                <span class="dt">sd1i =</span> sd.C, <span class="dt">sd2i =</span> sd.E,
                <span class="dt">n1i =</span> n.C, <span class="dt">n2i =</span> n.E,
                <span class="dt">measure =</span> <span class="st">"SMD"</span>)
<span class="co">#&gt;        yi     vi</span>
<span class="co">#&gt; 1 -0.0736 0.0674</span></code></pre></div>
</div>
<div id="escalc-formula-notation-application" class="section level3">
<h3 class="hasAnchor">
<a href="#escalc-formula-notation-application" class="anchor"></a>escalc formula notation application</h3>
<p>So far we’ve focused on the results of data collected on a single allele of the able gene by a single student. Now let’s use the full dataset, sxn1_summary, which has data on all 18 alleles for a single class. The only difference is the dataset I’m using (data = sxn1_summary) and I’ve added “var.names =…” to give the output informative column labels.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sx1n1_SMD &lt;-<span class="st"> </span><span class="kw">escalc</span>(mean<span class="op">/</span>sd <span class="op">~</span><span class="st"> </span>E.or.C <span class="op">|</span><span class="st"> </span><span class="kw">factor</span>(student.ID),
       <span class="dt">weights =</span> n,
       <span class="dt">measure =</span> <span class="st">"SMD"</span>, 
       <span class="dt">data =</span> sxn1_summary,
       <span class="dt">var.names =</span> <span class="kw">c</span>(<span class="st">"effect.size.SMD"</span>,
                     <span class="st">"var.SMD"</span>),
       <span class="dt">append =</span> T)
       </code></pre></div>
<p>We now get a dataframe with 18. The top row should match our previous calculations. Let’s use the head() command to just look at the 1st few rows.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(sx1n1_SMD)
<span class="co">#&gt;   effect.size.SMD var.SMD</span>
<span class="co">#&gt; 1         -0.0736  0.0674</span>
<span class="co">#&gt; 2         -0.3407  0.0852</span>
<span class="co">#&gt; 3          0.2990  0.0906</span>
<span class="co">#&gt; 4              NA      NA</span>
<span class="co">#&gt; 5         -0.1462  0.1398</span>
<span class="co">#&gt; 6          0.9768  0.2320</span></code></pre></div>
<p>escalc gives us the variance for the effects size. We can get the confidence intervals using summary()</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sx1n1_SMD_summary &lt;-<span class="st"> </span><span class="kw">summary</span>(sx1n1_SMD)</code></pre></div>
<p>Look at the output</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(sx1n1_SMD_summary)
<span class="co">#&gt;   effect.size.SMD var.SMD    sei      zi   ci.lb  ci.ub</span>
<span class="co">#&gt; 1         -0.0736  0.0674 0.2596 -0.2836 -0.5824 0.4352</span>
<span class="co">#&gt; 2         -0.3407  0.0852 0.2919 -1.1672 -0.9129 0.2314</span>
<span class="co">#&gt; 3          0.2990  0.0906 0.3011  0.9931 -0.2911 0.8891</span>
<span class="co">#&gt; 4              NA      NA     NA      NA      NA     NA</span>
<span class="co">#&gt; 5         -0.1462  0.1398 0.3739 -0.3909 -0.8790 0.5866</span>
<span class="co">#&gt; 6          0.9768  0.2320 0.4816  2.0282  0.0328 1.9207</span></code></pre></div>
<p>A major drawback of escalc formula notation is that it that labels for the effect sizes aren’t returned!</p>
<p>It looks like escalc alphabetizes things so we should be able to match up the names. To make sure we know what’s doing on we’ll keep track of the group means to double check things.</p>
<p>To do this we need to reshape our data. Right now, our sxn1_summary dataframe has a seperate row for the control and experimental mean for each allele; this means there are 36 rows (18 alleles x 2 experimental groups)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(sxn1_summary)
<span class="co">#&gt; # A tibble: 6 x 7</span>
<span class="co">#&gt; # Groups:   E.or.C, gene.allele, allele [6]</span>
<span class="co">#&gt;   E.or.C gene.allele allele       student.ID  mean      sd     n</span>
<span class="co">#&gt;   &lt;fct&gt;  &lt;fct&gt;       &lt;fct&gt;        &lt;fct&gt;      &lt;dbl&gt;   &lt;dbl&gt; &lt;int&gt;</span>
<span class="co">#&gt; 1 C      abl.1       abl[2]       1           4.64   0.742    33</span>
<span class="co">#&gt; 2 C      abl.2       abl[04674]   2           3.91   1.44     35</span>
<span class="co">#&gt; 3 C      abl.3       Df(3L)ED223  3           4.56   1.58     27</span>
<span class="co">#&gt; 4 C      dia.1       dia[2]       10          3    NaN         1</span>
<span class="co">#&gt; 5 C      dia.2       dia[5]       11          3.88   1.02     16</span>
<span class="co">#&gt; 6 C      dia.3       Df(2L)ED1317 12          6.17   1.17      6</span>
<span class="kw">dim</span>(sxn1_summary)
<span class="co">#&gt; [1] 36  7</span></code></pre></div>
<p>Our table of effect sizes, however, combines the row for the Control group and the row for the experimental group into a single effect size, and so has just 18 rows.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sx1n1_SMD
<span class="co">#&gt;    effect.size.SMD var.SMD</span>
<span class="co">#&gt; 1          -0.0736  0.0674</span>
<span class="co">#&gt; 2          -0.3407  0.0852</span>
<span class="co">#&gt; 3           0.2990  0.0906</span>
<span class="co">#&gt; 4               NA      NA</span>
<span class="co">#&gt; 5          -0.1462  0.1398</span>
<span class="co">#&gt; 6           0.9768  0.2320</span>
<span class="co">#&gt; 7           3.9013  0.3282</span>
<span class="co">#&gt; 8           0.7317  0.1058</span>
<span class="co">#&gt; 9          -0.1307  0.1195</span>
<span class="co">#&gt; 10          1.0546  0.1507</span>
<span class="co">#&gt; 11          1.0928  0.0717</span>
<span class="co">#&gt; 12         -0.2379  0.1372</span>
<span class="co">#&gt; 13          3.4756  0.9420</span>
<span class="co">#&gt; 14          0.8544  0.3021</span>
<span class="co">#&gt; 15          0.4856  0.1005</span>
<span class="co">#&gt; 16          1.5746  0.3819</span>
<span class="co">#&gt; 17          0.0595  0.2292</span>
<span class="co">#&gt; 18         -0.7189  0.1126</span></code></pre></div>
<p>So what we need to do is reshape our 36-row sxn1_summary dataframe into an 18 row dataframe with the a seperate column for each mean.</p>
<p>To do this reshaping we’ll use a cool function from the <strong>data.table</strong> package called <strong>dcast</strong> (actually dcast.data.table). “Casting” is an older approach to data reshaping the predates the <strong>tidyverse</strong> of packages. As best I can tell, the <strong>dcast.data.table</strong> is the best tool for what we need to do. This following code is a bit complicated and not yet fully annotated, sorry.</p>
<p><strong>dcast</strong> stands for “data.frame cast” and to the best of my knowledge originated from the reshape2 package. reshape2 used the verbs <strong>melt</strong> and <strong>cast</strong> to describe reshaping data. reshape2 seems to have been largely been replaced by dplyr and tidyr, which use <strong>gather</strong> and <strong>spread</strong>. I like <strong>dcast</strong> syntax and logic better, and as best I can tell <strong>dcast.data.table</strong> does some things that <strong>spread</strong> can’t, though this may just be my ignorance of the full power of the tidyverse.</p>
<p><strong>dcast.data.table</strong> (and <strong>dcast</strong> before it) use a <strong>formula interface</strong> to express how to manipulate data. Its a bit hard to describe the logic behind it. Basically, in the formula below I am using gene.allele (which has values like “able.1”) and allele (eg “able”) as ID variable columns, and the column E.or.C, which contains the values “E” or “C” for the experimental groups, defines a new column (or in this case column)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my.cast.formula &lt;-<span class="st"> </span><span class="kw">formula</span>(gene.allele <span class="op">+</span><span class="st"> </span>allele <span class="op">~</span><span class="st"> </span>E.or.C)</code></pre></div>
<p>dcast.data.table works on data.table objects, not data.frames or tibbles, so I need to convert my effect size summary object sxn1_summary, which is a tibble, to a data.frame object.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#what is sxn1_summary?</span>
<span class="kw">is</span>(sxn1_summary)[<span class="dv">2</span>]
<span class="co">#&gt; [1] "tbl_df"</span>

<span class="co">#convert to data.table</span>
sxn1_summary_dt &lt;-<span class="st"> </span><span class="kw">data.table</span>(sxn1_summary)

<span class="co">#wht is new object?</span>
<span class="kw">is</span>(sxn1_summary_dt)[<span class="dv">1</span>]
<span class="co">#&gt; [1] "data.table"</span></code></pre></div>
<p>dcast.data.table also takes an an argument value.var (“Value variables”), which are the columns that I want to be split up into new columns. This will be my columns for means,SDs, and sample size (n). Right now there are one columns for each of these, with values for controls (“C”) and experimental (“E”) within the same column. dcast.data.table will take each of these columns and reshape it from 3 columns to 6. So instead of a single mean column, I“ll have control-mean and experimental mean, control-sd and experimental-sd, etc.</p>
<p>I’ll but my value variables into a vector</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my.vars &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">"mean"</span>,<span class="st">"sd"</span>,<span class="st">"n"</span>)</code></pre></div>
<p>Finally the magic</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sxn1_wide &lt;-<span class="st"> </span><span class="kw">dcast.data.table</span>(<span class="dt">data =</span> sxn1_summary_dt,
                 <span class="dt">formula =</span> my.cast.formula,
                 <span class="dt">value.var =</span> my.vars)</code></pre></div>
<p>I’ll us as.tbl() to convert it to a tibble so we can see what it looks like</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sxn1_wide &lt;-<span class="st"> </span><span class="kw">as.tbl</span>(sxn1_wide)

<span class="kw">dim</span>(sxn1_wide)
<span class="co">#&gt; [1] 18  8</span>
<span class="kw">head</span>(sxn1_wide)
<span class="co">#&gt; # A tibble: 6 x 8</span>
<span class="co">#&gt;   gene.allele allele       mean_C mean_E    sd_C  sd_E   n_C   n_E</span>
<span class="co">#&gt;   &lt;fct&gt;       &lt;fct&gt;         &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt;</span>
<span class="co">#&gt; 1 abl.1       abl[2]         4.64   4.70   0.742 1.07     33    27</span>
<span class="co">#&gt; 2 abl.2       abl[04674]     3.91   4.61   1.44  2.83     35    18</span>
<span class="co">#&gt; 3 abl.3       Df(3L)ED223    4.56   4.16   1.58  0.765    27    19</span>
<span class="co">#&gt; 4 dia.1       dia[2]         3      3.73 NaN     1.28      1    15</span>
<span class="co">#&gt; 5 dia.2       dia[5]         3.88   4.08   1.02  1.66     16    13</span>
<span class="co">#&gt; 6 dia.3       Df(2L)ED1317   6.17   5.29   1.17  0.784     6    21</span></code></pre></div>
<p>The dataframe is 18 rows by 8 columns, with columns names including mean_C, mean_E,sd_C,sd_E and n_C.</p>
<p>Compare this to the starting “long” dataframe.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dim</span>(sxn1_summary)
<span class="co">#&gt; [1] 36  7</span>
<span class="kw">head</span>(sxn1_summary)
<span class="co">#&gt; # A tibble: 6 x 7</span>
<span class="co">#&gt; # Groups:   E.or.C, gene.allele, allele [6]</span>
<span class="co">#&gt;   E.or.C gene.allele allele       student.ID  mean      sd     n</span>
<span class="co">#&gt;   &lt;fct&gt;  &lt;fct&gt;       &lt;fct&gt;        &lt;fct&gt;      &lt;dbl&gt;   &lt;dbl&gt; &lt;int&gt;</span>
<span class="co">#&gt; 1 C      abl.1       abl[2]       1           4.64   0.742    33</span>
<span class="co">#&gt; 2 C      abl.2       abl[04674]   2           3.91   1.44     35</span>
<span class="co">#&gt; 3 C      abl.3       Df(3L)ED223  3           4.56   1.58     27</span>
<span class="co">#&gt; 4 C      dia.1       dia[2]       10          3    NaN         1</span>
<span class="co">#&gt; 5 C      dia.2       dia[5]       11          3.88   1.02     16</span>
<span class="co">#&gt; 6 C      dia.3       Df(2L)ED1317 12          6.17   1.17      6</span></code></pre></div>
<p>This is 36 rows tall.</p>
<p>Now that we have our data in wide format we can calculate the difference between means by hand. I’ll call this mean.diff.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sxn1_wide<span class="op">$</span>effect.size.MD &lt;-<span class="st"> </span>sxn1_wide<span class="op">$</span>mean_C <span class="op">-</span><span class="st"> </span>sxn1_wide<span class="op">$</span>mean_E</code></pre></div>
<p>I’ll re-do my effect size calculations using measure = “MD” instead of RMD so I can compare things easily to my hand calculation of the mean difference (effect.size.MD)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sx1n1_MD &lt;-<span class="st"> </span><span class="kw">escalc</span>(mean<span class="op">/</span>sd <span class="op">~</span><span class="st"> </span>E.or.C <span class="op">|</span><span class="st"> </span><span class="kw">factor</span>(student.ID),
       <span class="dt">weights =</span> n,
       <span class="dt">measure =</span> <span class="st">"MD"</span>, 
       <span class="dt">data =</span> sxn1_summary,
       <span class="dt">var.names =</span> <span class="kw">c</span>(<span class="st">"effect.size.MD"</span>,
                     <span class="st">"MD.var"</span>),
       <span class="dt">append =</span> T)
       </code></pre></div>
<p>Again, the whole point of this is to try to figure out how escalc organizes its output, and to associate the correct allele and gene names with its output. My table sxn1_wide that I made with the dcast.data.table function has these keys variables: gene names, allele names, means by group (E and C) and SDs by group.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">names</span>(sxn1_wide)
<span class="co">#&gt; [1] "gene.allele"    "allele"         "mean_C"         "mean_E"        </span>
<span class="co">#&gt; [5] "sd_C"           "sd_E"           "n_C"            "n_E"           </span>
<span class="co">#&gt; [9] "effect.size.MD"</span></code></pre></div>
<p>dcast.data.table automatically organizes its output alphabetically and numerically, so abl.1 is first, abl.2 is second, abl.3 is third, and dia.1 is forth.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(sxn1_wide)
<span class="co">#&gt; # A tibble: 6 x 9</span>
<span class="co">#&gt;   gene.allele alle~ mean_C mean_E    sd_C  sd_E   n_C   n_E effect.size.MD</span>
<span class="co">#&gt;   &lt;fct&gt;       &lt;fct&gt;  &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt;          &lt;dbl&gt;</span>
<span class="co">#&gt; 1 abl.1       abl[~   4.64   4.70   0.742 1.07     33    27        -0.0673</span>
<span class="co">#&gt; 2 abl.2       abl[~   3.91   4.61   1.44  2.83     35    18        -0.697 </span>
<span class="co">#&gt; 3 abl.3       Df(3~   4.56   4.16   1.58  0.765    27    19         0.398 </span>
<span class="co">#&gt; 4 dia.1       dia[~   3      3.73 NaN     1.28      1    15        -0.733 </span>
<span class="co">#&gt; 5 dia.2       dia[~   3.88   4.08   1.02  1.66     16    13        -0.202 </span>
<span class="co">#&gt; 6 dia.3       Df(2~   6.17   5.29   1.17  0.784     6    21         0.881</span></code></pre></div>
<p>In contrast, the object sx1n1_MD that I just now with escalc only has effect sizes and effect size variances.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">names</span>(sx1n1_MD)
<span class="co">#&gt; [1] "effect.size.MD" "MD.var"</span></code></pre></div>
<p>I believe that escalc is organizing things alphabetically. If that’s true, then the effect sizes in the escalc object sx1n1_MD should match those I calculated by hand in the sxn1_wide object. I can test this by plotting them against each other.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(sxn1_wide<span class="op">$</span>effect.size.MD, 
     sx1n1_MD<span class="op">$</span>effect.size.MD)</code></pre></div>
<p><img src="g1-calculating_effect_sizes_with_metafor_files/figure-html/unnamed-chunk-38-1.png" width="700"></p>
<p>Perfect!</p>
<p>I can now feel safe adding labels from sxn1_wide to sx1n1_SMD, which has the standardized mean difference (= COhen’s d, or more accurately Hedges g) I am interested in.</p>
<p>Because R is picky I have to use data.frame to make both of these objects the same class (for fun see the obtuse error message it gives you if you take data.frame out of the code below)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sx1n1 &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">data.frame</span>(sxn1_wide),
               <span class="kw">data.frame</span>(sx1n1_SMD))</code></pre></div>
<p>Now, after all our hard work, let’s see what we have</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">names</span>(sx1n1)
<span class="co">#&gt;  [1] "gene.allele"     "allele"          "mean_C"         </span>
<span class="co">#&gt;  [4] "mean_E"          "sd_C"            "sd_E"           </span>
<span class="co">#&gt;  [7] "n_C"             "n_E"             "effect.size.MD" </span>
<span class="co">#&gt; [10] "effect.size.SMD" "var.SMD"</span>
<span class="kw">head</span>(sx1n1)
<span class="co">#&gt;   gene.allele       allele   mean_C   mean_E      sd_C      sd_E n_C n_E</span>
<span class="co">#&gt; 1       abl.1       abl[2] 4.636364 4.703704 0.7423856 1.0675210  33  27</span>
<span class="co">#&gt; 2       abl.2   abl[04674] 3.914286 4.611111 1.4424536 2.8313142  35  18</span>
<span class="co">#&gt; 3       abl.3  Df(3L)ED223 4.555556 4.157895 1.5770794 0.7647191  27  19</span>
<span class="co">#&gt; 4       dia.1       dia[2] 3.000000 3.733333       NaN 1.2798809   1  15</span>
<span class="co">#&gt; 5       dia.2       dia[5] 3.875000 4.076923 1.0246951 1.6563785  16  13</span>
<span class="co">#&gt; 6       dia.3 Df(2L)ED1317 6.166667 5.285714 1.1690452 0.7837638   6  21</span>
<span class="co">#&gt;   effect.size.MD effect.size.SMD    var.SMD</span>
<span class="co">#&gt; 1    -0.06734007     -0.07362611 0.06738524</span>
<span class="co">#&gt; 2    -0.69682540     -0.34074605 0.08522234</span>
<span class="co">#&gt; 3     0.39766082      0.29897415 0.09064020</span>
<span class="co">#&gt; 4    -0.73333333              NA         NA</span>
<span class="co">#&gt; 5    -0.20192308     -0.14616835 0.13979144</span>
<span class="co">#&gt; 6     0.88095238      0.97679254 0.23195467</span></code></pre></div>
</div>
</div>
<div id="plotting-effect-size" class="section level2">
<h2 class="hasAnchor">
<a href="#plotting-effect-size" class="anchor"></a>Plotting effect size</h2>
<p>A quick way to plot effect sizes is to use the forest() function in metafor. I’m not super excited about its output, but it quickly gives you a visualization. It takes the arguments</p>
<ul>
<li>x: the effect sizes</li>
<li>vi: the variances for the effect sizes</li>
<li>slab: labels for effect size (usually study names for a meta-analysis; alleles for our work)</li>
<li>xlim: limits of the horizontal axis, which I had to make small to get rid of lots of excess white space</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">metafor<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/metafor/topics/forest">forest</a></span>(<span class="dt">x =</span> sx1n1<span class="op">$</span>effect.size.SMD, 
       <span class="dt">vi =</span> sx1n1<span class="op">$</span>var.SMD,
       <span class="dt">slab =</span> sx1n1<span class="op">$</span>gene.allele,
       <span class="dt">annotate =</span> F,
       <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">2.75</span>,<span class="fl">3.25</span>))</code></pre></div>
<p><img src="g1-calculating_effect_sizes_with_metafor_files/figure-html/unnamed-chunk-41-1.png" width="700"></p>
<p>Recall that we got confidence intervals using summary(). We can feed that into a plot on our own, once we get some time…</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li><a href="#preliminaries">Preliminaries</a></li>
      <li><a href="#summarizing-data-by-group">Summarizing data by group</a></li>
      <li><a href="#calculate-effect-sizes">Calculate effect sizes</a></li>
      <li><a href="#multiple-effect-sizes-escalc-formula-notation">Multiple effect sizes: escalc formula notation</a></li>
      <li><a href="#plotting-effect-size">Plotting effect size</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by First Last.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  
</body>
</html>
