<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
<ol start="6" style="list-style-type: lower-alpha">
<li>Analysis walthrough: t-test and friends</li>
</ol> • shroom</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="&lt;ol start=" style="list-style-type: lower-alpha">
</head>
<body>
<li>Analysis walthrough: t-test and friends</li>
" /&gt;

<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">shroom</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/a1-introduction.html">a) Introduction to the shroom package</a>
    </li>
    <li>
      <a href="../articles/a2-intro_to_ind_project_questions.html">a) Introduction to shroom</a>
    </li>
    <li>
      <a href="../articles/b-loading_the_shroom_package.html">b) Loading the shroom package</a>
    </li>
    <li>
      <a href="../articles/c-subsetting_a_dataframe_with_dplyr.html">c) Subsetting a dataframe with dplyr</a>
    </li>
    <li>
      <a href="../articles/d-summarizing_data_with_dplyr.html">d) Summarizing data with dplyr</a>
    </li>
    <li>
      <a href="../articles/f1-analysis_walkthrough_t_test_and_friends.html">f) Analysis walthrough: t-test and friends</a>
    </li>
    <li>
      <a href="../articles/f3-analysis_walkthrough_2-way_ANOVA.html">f) Analysis walthrough: 2-way factorial model</a>
    </li>
    <li>
      <a href="../articles/f4-analysis_walkthrough_nested_ANOVA.html">f) Analysis walthrough: 2-way factorial model</a>
    </li>
    <li>
      <a href="../articles/g1-calculating_effect_sizes_with_metafor.html">e) Calculating effect sizes using the metafor package</a>
    </li>
    <li>
      <a href="../articles/g2-analysis_of_difference_scores.html">f) Analysis of difference scores: thinking about effect sizes, sample sizes &amp; effect size variances</a>
    </li>
    <li>
      <a href="../articles/s1-stub-probablistic_index_models.html">s1) Stub - Probablistic index models</a>
    </li>
    <li>
      <a href="../articles/y-creating_a_package.html">w) Creating this package</a>
    </li>
    <li>
      <a href="../articles/z-build_and_rebuild_package.html">z) Building and rebuilding vignettes</a>
    </li>
    <li>
      <a href="../articles/z2-building_a_package.html">z2) Building and rebuilding vignettes - orig</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1><ol start="6" style="list-style-type: lower-alpha">
<li>Analysis walthrough: t-test and friends</li>
</ol></h1>
                        <h4 class="author">Nathan Brouwer</h4>
            
            <h4 class="date">2018-11-28</h4>
      
      
      <div class="hidden name"><code>f1-analysis_walkthrough_t_test_and_friends.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>This tutorial walks through several types of anlayses that can be done using the shroom package. THe focus will be data on using t-tests and similar methods to compare two groups. In particular</p>
<ul>
<li>Testing for groups differences using a t-test (t.test</li>
<li>Cohen’s d effect size for the differene between 2 means (cohen.d)</li>
<li>Formulating a t-test as a linear model (lm)</li>
<li>Non-parametric test for ranked data (wilcox.test)</li>
<li>Non-parametric for skewed rank data (brunner.munzel.test)</li>
</ul>
<p>(TO DO: gls for Welch-type tests; effect size calculations with metafor; effect size for non-parametric tests)</p>
</div>
<div id="preliminaries" class="section level2">
<h2 class="hasAnchor">
<a href="#preliminaries" class="anchor"></a>Preliminaries</h2>
<div id="load-packages" class="section level3">
<h3 class="hasAnchor">
<a href="#load-packages" class="anchor"></a>Load packages</h3>
<p>Load the shroom package. You can download it with instal.packages(“shroom”) if you haven’t used it ever before. See “Loading the shroom package” for more information.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(shroom)</code></pre></div>
<p>Load other essential packages</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggpubr)  <span class="co">#plotting</span>
<span class="co">#&gt; Loading required package: ggplot2</span>
<span class="co">#&gt; Loading required package: magrittr</span>
<span class="kw">library</span>(cowplot)
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'cowplot'</span>
<span class="co">#&gt; The following object is masked from 'package:ggpubr':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     get_legend</span>
<span class="co">#&gt; The following object is masked from 'package:ggplot2':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     ggsave</span>

<span class="kw">library</span>(dplyr)   <span class="co">#data cleaning</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'dplyr'</span>
<span class="co">#&gt; The following objects are masked from 'package:stats':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     filter, lag</span>
<span class="co">#&gt; The following objects are masked from 'package:base':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     intersect, setdiff, setequal, union</span>

<span class="kw">library</span>(car)     <span class="co">#?</span>
<span class="co">#&gt; Loading required package: carData</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'car'</span>
<span class="co">#&gt; The following object is masked from 'package:dplyr':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     recode</span>

<span class="kw">library</span>(data.tree)<span class="co"># plotting data structure</span>
<span class="kw">library</span>(treemap)

<span class="kw">library</span>(plotrix) <span class="co">#std.err function</span>

<span class="kw">library</span>(bbmle)   <span class="co">#AIC table</span>
<span class="co">#&gt; Loading required package: stats4</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'bbmle'</span>
<span class="co">#&gt; The following object is masked from 'package:dplyr':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     slice</span>
<span class="kw">library</span>(lme4)
<span class="co">#&gt; Loading required package: Matrix</span>
<span class="kw">library</span>(lawstat) <span class="co">#?</span>
<span class="co">#&gt; Loading required package: Kendall</span>
<span class="co">#&gt; Loading required package: mvtnorm</span>
<span class="co">#&gt; Loading required package: VGAM</span>
<span class="co">#&gt; Loading required package: splines</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'VGAM'</span>
<span class="co">#&gt; The following object is masked from 'package:bbmle':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     AICc</span>
<span class="co">#&gt; The following object is masked from 'package:car':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     logit</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'lawstat'</span>
<span class="co">#&gt; The following object is masked from 'package:car':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     levene.test</span>
<span class="kw">library</span>(effsize) <span class="co">#Cohen's dw</span></code></pre></div>
</div>
<div id="load-data" class="section level3">
<h3 class="hasAnchor">
<a href="#load-data" class="anchor"></a>Load data</h3>
<div id="loading-data-directly-from-the-shroom-package" class="section level4">
<h4 class="hasAnchor">
<a href="#loading-data-directly-from-the-shroom-package" class="anchor"></a>Loading data directly from the shroom package</h4>
<p>The data are internal to the package and so can be easily loaded.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(<span class="st">"wingscores"</span>)</code></pre></div>
</div>
<div id="loading-the-data-from-the-shroom-package" class="section level4">
<h4 class="hasAnchor">
<a href="#loading-the-data-from-the-shroom-package" class="anchor"></a>Loading the data from the shroom package</h4>
<p>For a real analysis you need to start from the .csv file with the raw data, data_ind_flies_expt1_2018.csv. This data is included when you download the package. If you search your computer for it you should be able to locate it. It is in a diretory called “extdata” within the directory for shroom package which you downloaded..</p>
<ol style="list-style-type: decimal">
<li>Save the file data_ind_flies_expt1_2018.csv to where you want to do your work for this project</li>
<li>Set your working directory to the same folder where the file is saved. This can be done through “Session” option of the RStudio menu (this will occur automatically if you are using an R project).</li>
<li>Load the data using read.csv OR the “Import Dataset” button within RStudio</li>
</ol>
<p>Using the “Import Dataset” button is helpful because it brings up a file navigation system that is similar to a normal program and generates the code you need to load the data.</p>
<p><strong>Its good to copy and paste this code into your script so you always have it.</strong></p>
<p>Note that the code generated by “Import Dataset” creates an <strong>absolute path</strong> for the file name. This means that if you move the file that the original code will no longer work and you will have to got back through the “Import Dataset” process again.</p>
</div>
<div id="adanced-loading-data-using-relative-file-paths" class="section level4">
<h4 class="hasAnchor">
<a href="#adanced-loading-data-using-relative-file-paths" class="anchor"></a>Adanced: Loading data using relative file paths</h4>
<p>Because I am familiar with the ins and outs of R I use “relative file paths”; if I move files, my code accomodates them being moved. However, this is a bit abstract and is more advanced. <strong>You are encouraged to skip this section if you are new to R.</strong></p>
<p>There here() fuction of there here packages tells me where an RStudio project file is.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">here<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/here/topics/here">here</a></span>()
<span class="co">#&gt; [1] "C:/Users/lisanjie/Documents/shroom_master/shroom"</span></code></pre></div>
<p>I can construct a valid, flexible flie path using here::here()</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># You don't need to do this</span>
path. &lt;-<span class="st"> </span>here<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/here/topics/here">here</a></span>(<span class="st">"inst/extdata"</span>)</code></pre></div>
<p>What is in the directory</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">list.files</span>(path.)
<span class="co">#&gt; [1] "data_ind_fly_wing_scores_2018.csv"</span></code></pre></div>
<p>Full file path</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">file. &lt;-<span class="st"> </span>here<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/here/topics/here">here</a></span>(<span class="st">"inst/extdata/data_ind_fly_wing_scores_2018.csv"</span>)</code></pre></div>
<p>I then load the data</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># load data using path and file saved in file. object</span>
flies &lt;-<span class="st"> </span><span class="kw">read.csv</span>(file.)</code></pre></div>
</div>
</div>
</div>
<div id="cleaning-and-subsetting-the-wing-data" class="section level2">
<h2 class="hasAnchor">
<a href="#cleaning-and-subsetting-the-wing-data" class="anchor"></a>Cleaning and subsetting the wing data</h2>
<p>This information is covered in more detail in “Subsetting a dataframe with dplyr.”</p>
<div id="examine-raw-data" class="section level3">
<h3 class="hasAnchor">
<a href="#examine-raw-data" class="anchor"></a>Examine raw data</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dim</span>(flies)
<span class="co">#&gt; [1] 7754   16</span>
<span class="kw">names</span>(flies)
<span class="co">#&gt;  [1] "student.ID"  "seat"        "gene"        "allele"      "section"    </span>
<span class="co">#&gt;  [6] "file"        "loaded"      "E.or.C"      "sex"         "group"      </span>
<span class="co">#&gt; [11] "wing.score"  "stock.num"   "temp.C"      "allele.num"  "gene.shrt"  </span>
<span class="co">#&gt; [16] "gene.allele"</span>
<span class="kw">head</span>(flies)
<span class="co">#&gt;   student.ID seat gene allele section         file loaded E.or.C sex group</span>
<span class="co">#&gt; 1          1    1  abl abl[2]    AM.M wing_01.xlsm loaded      E   M   E.M</span>
<span class="co">#&gt; 2          1    1  abl abl[2]    AM.M wing_01.xlsm loaded      E   M   E.M</span>
<span class="co">#&gt; 3          1    1  abl abl[2]    AM.M wing_01.xlsm loaded      E   M   E.M</span>
<span class="co">#&gt; 4          1    1  abl abl[2]    AM.M wing_01.xlsm loaded      E   M   E.M</span>
<span class="co">#&gt; 5          1    1  abl abl[2]    AM.M wing_01.xlsm loaded      E   M   E.M</span>
<span class="co">#&gt; 6          1    1  abl abl[2]    AM.M wing_01.xlsm loaded      E   M   E.M</span>
<span class="co">#&gt;   wing.score stock.num temp.C allele.num gene.shrt gene.allele</span>
<span class="co">#&gt; 1          5      8565     25          1       abl       abl.1</span>
<span class="co">#&gt; 2          5      8565     25          1       abl       abl.1</span>
<span class="co">#&gt; 3          5      8565     25          1       abl       abl.1</span>
<span class="co">#&gt; 4          5      8565     25          1       abl       abl.1</span>
<span class="co">#&gt; 5          5      8565     25          1       abl       abl.1</span>
<span class="co">#&gt; 6          5      8565     25          1       abl       abl.1</span></code></pre></div>
</div>
<div id="clean-the-raw-data" class="section level3">
<h3 class="hasAnchor">
<a href="#clean-the-raw-data" class="anchor"></a>Clean the raw data</h3>
<ul>
<li>Remove some un-needed columns using select().<br>
</li>
<li>Note “-” before each column name.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">flies &lt;-<span class="st"> </span>flies <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="op">-</span>stock.num,
                          <span class="op">-</span>loaded,
                          <span class="op">-</span>file,
                          <span class="op">-</span>gene,
                          <span class="op">-</span>temp.C)</code></pre></div>
<p>Data frame now has fewer columns</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dim</span>(flies)
<span class="co">#&gt; [1] 7754   11</span></code></pre></div>
</div>
</div>
<div id="data-analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#data-analysis" class="anchor"></a>Data analysis</h2>
<p>We will walk through analyses comparing just two groups: female control flies versus female experimental flies. In subsequent tutorials we’ll look at more complex data.</p>
<div id="nomeclature-student-vs--fly-level-data" class="section level3">
<h3 class="hasAnchor">
<a href="#nomeclature-student-vs--fly-level-data" class="anchor"></a>Nomeclature: “Student”" vs. “fly-level”" data</h3>
<p>Because these data result from summarizing the work done by each student, I will refer to it as <strong>student-level data</strong>. In contrast, the raw data generated by the student is <strong>fly-level</strong> data because each data point represents a single fly.</p>
</div>
<div id="data-from-1-student-t-test" class="section level3">
<h3 class="hasAnchor">
<a href="#data-from-1-student-t-test" class="anchor"></a>Data from 1 student: t-test</h3>
<ul>
<li>Extract data for a single student using the dplyr::filter() command.</li>
<li>Select on TWO conditions: student.ID == 1 AND sex == “F”</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">student1.F &lt;-<span class="st"> </span>flies <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(student.ID <span class="op">==</span><span class="st">  </span><span class="dv">1</span> <span class="op">&amp;</span>
<span class="st">                                    </span>sex <span class="op">==</span><span class="st"> "F"</span>)</code></pre></div>
<p>Data frame now has many fewer rows</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dim</span>(student1.F)
<span class="co">#&gt; [1] 24 11</span></code></pre></div>
<div id="data-exploration" class="section level4">
<h4 class="hasAnchor">
<a href="#data-exploration" class="anchor"></a>Data exploration</h4>
<p>Examine the data and consider the issues raised by Consider the issues raied by Zuur et al 2010</p>
</div>
<div id="structure-of-the-data" class="section level4">
<h4 class="hasAnchor">
<a href="#structure-of-the-data" class="anchor"></a>Structure of the data</h4>
<p>We can think of the data like this</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">working &lt;-<span class="st"> </span>student1.F
working<span class="op">$</span>i &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(working)

i.E &lt;-<span class="st"> </span><span class="kw">which</span>(working<span class="op">$</span>E.or.C <span class="op">==</span><span class="st"> "E"</span>)

i.use &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">min</span>(working<span class="op">$</span>i[i.E])
,<span class="kw">min</span>(working<span class="op">$</span>i[i.E])<span class="op">+</span><span class="dv">1</span>
,<span class="kw">max</span>(working<span class="op">$</span>i[i.E])<span class="op">-</span><span class="dv">1</span>
,<span class="kw">max</span>(working<span class="op">$</span>i[i.E])
,<span class="kw">min</span>(working<span class="op">$</span>i[<span class="op">-</span>i.E])
,<span class="kw">min</span>(working<span class="op">$</span>i[<span class="op">-</span>i.E])<span class="op">+</span><span class="dv">1</span>
,<span class="kw">max</span>(working<span class="op">$</span>i[<span class="op">-</span>i.E])<span class="op">-</span><span class="dv">1</span>
,<span class="kw">max</span>(working<span class="op">$</span>i[<span class="op">-</span>i.E]))

i.medians &lt;-<span class="st"> </span><span class="kw">round</span>(<span class="kw">c</span>(<span class="kw">median</span>(working<span class="op">$</span>i[i.E])
,<span class="kw">median</span>(working<span class="op">$</span>i[<span class="op">-</span>i.E])),<span class="dv">0</span>)



working[<span class="op">-</span>i.use, <span class="st">"i"</span>] &lt;-<span class="st"> "*</span><span class="ch">\n</span><span class="st">*</span><span class="ch">\n</span><span class="st">*"</span>



working<span class="op">$</span>pathString &lt;-<span class="st"> </span><span class="kw">with</span>(working,
                              <span class="kw">paste</span>(allele,
                                    E.or.C,
                                    i,
                                    <span class="dt">sep =</span> <span class="st">"/"</span>))

i &lt;-<span class="st"> </span><span class="kw">sort</span>(<span class="kw">c</span>(i.use,i.medians))
working.tree &lt;-<span class="st"> </span><span class="kw">as.Node</span>(working[i,])

<span class="kw">SetGraphStyle</span>(working.tree,
              <span class="dt">rankdir=</span><span class="st">"LR"</span>)

<span class="kw">plot</span>(working.tree)
     </code></pre></div>
<div id="plot-histogram-using-ggpubrgghistogram" class="section level5">
<h5 class="hasAnchor">
<a href="#plot-histogram-using-ggpubrgghistogram" class="anchor"></a>Plot histogram using ggpubr::gghistogram</h5>
<ul>
<li>Is data normal?</li>
<li>is data skewed?</li>
<li>Is variance constant between groups?</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">gghistogram</span>(<span class="dt">data =</span> student1.F,
            <span class="dt">x =</span> <span class="st">"wing.score"</span>,
            <span class="dt">fill =</span> <span class="st">"E.or.C"</span>, 
            <span class="dt">add =</span> <span class="st">"mean"</span>,       <span class="co">#add line formean</span>
            <span class="dt">position =</span> <span class="st">"dodge"</span>) <span class="co">#</span>
<span class="co">#&gt; Warning: Using `bins = 30` by default. Pick better value with the argument</span>
<span class="co">#&gt; `bins`.</span></code></pre></div>
<p><img src="f1-analysis_walkthrough_t_test_and_friends_files/figure-html/plot.histogram.1-1.png" width="700"></p>
</div>
<div id="plot-boxplot" class="section level5">
<h5 class="hasAnchor">
<a href="#plot-boxplot" class="anchor"></a>Plot boxplot</h5>
<ul>
<li>Is data normal?</li>
<li>is data skewed?</li>
<li>Is variance of different groups constant?</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggboxplot</span>(<span class="dt">data =</span> student1.F,
            <span class="dt">y =</span> <span class="st">"wing.score"</span>,
            <span class="dt">x =</span> <span class="st">"E.or.C"</span>,
            <span class="dt">add =</span> <span class="st">"mean"</span>,
            <span class="dt">fill =</span> <span class="st">"E.or.C"</span>)</code></pre></div>
<p><img src="f1-analysis_walkthrough_t_test_and_friends_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
</div>
<div id="numeric-summaries" class="section level5">
<h5 class="hasAnchor">
<a href="#numeric-summaries" class="anchor"></a>Numeric summaries</h5>
<p>Numeric summaries are useful when writing about the results and summarizing them for potential future meta-anlysts.</p>
<p>Step:</p>
<ul>
<li>group_by(E.or.C) splits into treatments</li>
<li>numeric summaries (mean, sd) called on wing score</li>
<li>note that I can do math within summarize()</li>
<li>std.error function is from plotrix package</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">student1.F <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(E.or.C) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarize</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(wing.score),
            <span class="dt">n =</span> <span class="kw">n</span>(),
            <span class="dt">sd =</span> <span class="kw">sd</span>(wing.score),
            <span class="dt">se =</span> plotrix<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/plotrix/topics/std.error">std.error</a></span>(wing.score),
            <span class="dt">CI95 =</span> <span class="fl">1.96</span><span class="op">*</span><span class="kw">std.error</span>(wing.score))
<span class="co">#&gt; # A tibble: 2 x 6</span>
<span class="co">#&gt;   E.or.C  mean     n    sd    se  CI95</span>
<span class="co">#&gt;   &lt;fct&gt;  &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1 C       4.38    16 0.619 0.155 0.303</span>
<span class="co">#&gt; 2 E       3.25     8 0.463 0.164 0.321</span></code></pre></div>
</div>
</div>
<div id="data-analysis-t-test" class="section level4">
<h4 class="hasAnchor">
<a href="#data-analysis-t-test" class="anchor"></a>Data analysis: t-test</h4>
<p>Consider these questions after you run the test:</p>
<ul>
<li>What are the assumptions of the t-test?</li>
<li>Are we violating them?</li>
<li>Which issues does Welch’s t-test solve?</li>
<li>Which issues does it NOT solve?</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">t.test</span>(wing.score <span class="op">~</span><span class="st"> </span>E.or.C, 
       <span class="dt">data =</span> student1.F)
<span class="co">#&gt; </span>
<span class="co">#&gt;  Welch Two Sample t-test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  wing.score by E.or.C</span>
<span class="co">#&gt; t = 4.9941, df = 18.293, p-value = 8.977e-05</span>
<span class="co">#&gt; alternative hypothesis: true difference in means is not equal to 0</span>
<span class="co">#&gt; 95 percent confidence interval:</span>
<span class="co">#&gt;  0.6522796 1.5977204</span>
<span class="co">#&gt; sample estimates:</span>
<span class="co">#&gt; mean in group C mean in group E </span>
<span class="co">#&gt;           4.375           3.250</span></code></pre></div>
</div>
<div id="cohens-d-effect-size" class="section level4">
<h4 class="hasAnchor">
<a href="#cohens-d-effect-size" class="anchor"></a>Cohen’s D effect size</h4>
<p>Cohen’s D is an relative <strong>effect size</strong> measure. It is sometiems called a <strong>standardized mean difference</strong> (SMD) because it is the difference between the means of two groups, “standardized” by a standard deviation pooled from from the 2 groups: (mean.1 - mean.2)/pooled.SD, where pooled.SD is a “weighted” mean of the two SDs. In meta analysis it is more commone now I think to use a simliar effecti size, <strong>Hedge’s g</strong>.</p>
<p>Cohen’s d makes all the same assumptions as a t-test BUT does NOT have the ability to correct like Welch’s t-test.</p>
<ul>
<li>Recent work, including some by ecologists, has shown that in meta-analysis Cohen’s D can become problematic because of issues realted to small sample sizes.<br>
</li>
<li>Additinally, I am not sure but I suspect with highly skewed data it is not a good measure of effect, but this is something I want to investigated</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">effsize<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/effsize/topics/cohen.d">cohen.d</a></span>(wing.score <span class="op">~</span><span class="st"> </span>E.or.C, 
       <span class="dt">data =</span> student1.F)
<span class="co">#&gt; </span>
<span class="co">#&gt; Cohen's d</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; d estimate: -2.172829 (large)</span>
<span class="co">#&gt; 95 percent confidence interval:</span>
<span class="co">#&gt;       inf       sup </span>
<span class="co">#&gt; -3.281639 -1.064018</span></code></pre></div>
</div>
<div id="analysis-t-test-as-linear-regression" class="section level4">
<h4 class="hasAnchor">
<a href="#analysis-t-test-as-linear-regression" class="anchor"></a>Analysis: T-test as linear regression</h4>
<ul>
<li>Fit 2 models</li>
<li>Note that there is no such thing as a “Welch’s linear model!” so non-constant variance is problematic. This can be corrected using a technique called <strong>generlized least squares</strong> (gls).</li>
<li>
</ul>
<div id="fit-linear-models" class="section level5">
<h5 class="hasAnchor">
<a href="#fit-linear-models" class="anchor"></a>Fit linear models</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m.H0 &lt;-<span class="st"> </span><span class="kw">lm</span>(wing.score <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,      <span class="dt">data =</span> student1.F)
m.Ha &lt;-<span class="st"> </span><span class="kw">lm</span>(wing.score <span class="op">~</span><span class="st"> </span>E.or.C, <span class="dt">data =</span> student1.F)</code></pre></div>
<p>We can also calcualte a <strong>means model</strong> by dropping the intercept</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m.means &lt;-<span class="st"> </span><span class="kw">lm</span>(wing.score <span class="op">~</span><span class="st"> </span><span class="op">-</span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>E.or.C, 
              <span class="dt">data =</span> student1.F)</code></pre></div>
</div>
<div id="intepret-model-equation" class="section level5">
<h5 class="hasAnchor">
<a href="#intepret-model-equation" class="anchor"></a>Intepret model equation</h5>
<p>The model has two paramters</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(m.Ha)
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; lm(formula = wing.score ~ E.or.C, data = student1.F)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residuals:</span>
<span class="co">#&gt;    Min     1Q Median     3Q    Max </span>
<span class="co">#&gt; -0.375 -0.375 -0.250  0.625  1.625 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="co">#&gt; (Intercept)   4.3750     0.1435  30.485  &lt; 2e-16 ***</span>
<span class="co">#&gt; E.or.CE      -1.1250     0.2486  -4.526 0.000167 ***</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residual standard error: 0.5741 on 22 degrees of freedom</span>
<span class="co">#&gt; Multiple R-squared:  0.4821, Adjusted R-squared:  0.4586 </span>
<span class="co">#&gt; F-statistic: 20.48 on 1 and 22 DF,  p-value: 0.000167</span></code></pre></div>
<p>The general model in R-like notation is wing.score ~ treatment</p>
<p>THis is defined by 2 parameters the intercept and the treatment effect. The treatment effect in this case corresponds to the difference between the two treatments.</p>
<p>The general model with both parameters is: wing.score ~ intercept + treatment.effect</p>
<p>We can plug in the values we have: wing.score ~ 4.8 + -0.63*(Experimental?)</p>
<p>where Experimental? = 0 if its the control treatment and 1 if its the experimental treatment. TWo equations are therefore implied</p>
<p>Control flies: wing.score ~ 4.8 + -0.63<em>0 Experimental flies: wing.score ~ 4.8 + -0.63</em>1</p>
<p>Which simplfies to</p>
<p>Control flies: wing.score ~ 4.8 Experimental flies: wing.score ~ 4.8 + -0.63</p>
</div>
<div id="inference" class="section level5">
<h5 class="hasAnchor">
<a href="#inference" class="anchor"></a>Inference</h5>
<p>We can compare the models using p-values or AIC.</p>
<p>Get p-value by comparing models using anova()</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">anova</span>(m.H0, <span class="co">#null model</span>
      m.Ha) <span class="co">#alternative model</span>
<span class="co">#&gt; Analysis of Variance Table</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model 1: wing.score ~ 1</span>
<span class="co">#&gt; Model 2: wing.score ~ E.or.C</span>
<span class="co">#&gt;   Res.Df   RSS Df Sum of Sq      F   Pr(&gt;F)    </span>
<span class="co">#&gt; 1     23 14.00                                 </span>
<span class="co">#&gt; 2     22  7.25  1      6.75 20.483 0.000167 ***</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></code></pre></div>
<p>Compare models with AIC. AICtab is from the package bbmle</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bbmle<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/bbmle/topics/ICtab">AICtab</a></span>(m.H0, m.Ha)
<span class="co">#&gt;      dAIC df</span>
<span class="co">#&gt; m.Ha  0.0 3 </span>
<span class="co">#&gt; m.H0 13.8 2</span></code></pre></div>
<p>AICc is a better choice than AIC. This requires ICtab()</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bbmle<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/bbmle/topics/ICtab">ICtab</a></span>(m.H0, 
              m.Ha,
             <span class="dt">type =</span> <span class="st">"AICc"</span>)
<span class="co">#&gt;      dAICc df</span>
<span class="co">#&gt; m.Ha  0.0  3 </span>
<span class="co">#&gt; m.H0 13.2  2</span></code></pre></div>
</div>
<div id="model-diagnostics" class="section level5">
<h5 class="hasAnchor">
<a href="#model-diagnostics" class="anchor"></a>Model diagnostics</h5>
<ul>
<li>t-test does not provide information on model residuals</li>
<li>lm() does</li>
<li>useful function: resid()</li>
</ul>
<p>In this context, resid subtracts the group mean (E or C) from each value. This is how much each observation differs from the group mean.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">resid</span>(m.Ha)
<span class="co">#&gt;      1      2      3      4      5      6      7      8      9     10 </span>
<span class="co">#&gt; -0.250 -0.250 -0.250 -0.250 -0.250 -0.250  0.750  0.750 -0.375 -0.375 </span>
<span class="co">#&gt;     11     12     13     14     15     16     17     18     19     20 </span>
<span class="co">#&gt; -0.375 -0.375 -0.375 -0.375 -0.375 -0.375 -0.375 -0.375 -0.375  0.625 </span>
<span class="co">#&gt;     21     22     23     24 </span>
<span class="co">#&gt;  0.625  0.625  0.625  1.625</span></code></pre></div>
<p>The mean of the residuals is approximately zero</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(<span class="kw">resid</span>(m.Ha))
<span class="co">#&gt; [1] -1.616816e-17</span></code></pre></div>
</div>
<div id="histogram-of-residuals" class="section level5">
<h5 class="hasAnchor">
<a href="#histogram-of-residuals" class="anchor"></a>Histogram of residuals</h5>
<ul>
<li>When data are normally distributed within each group, the residuals should be normal…</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(<span class="kw">resid</span>(m.Ha))</code></pre></div>
<p><img src="f1-analysis_walkthrough_t_test_and_friends_files/figure-html/unnamed-chunk-22-1.png" width="700"></p>
</div>
<div id="look-at-normality-with-a-qq-plot" class="section level5">
<h5 class="hasAnchor">
<a href="#look-at-normality-with-a-qq-plot" class="anchor"></a>Look at normality with a qq-plot</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(m.Ha, <span class="dt">which =</span> <span class="dv">2</span>)</code></pre></div>
<p><img src="f1-analysis_walkthrough_t_test_and_friends_files/figure-html/unnamed-chunk-24-1.png" width="700"></p>
</div>
</div>
<div id="transformations" class="section level4">
<h4 class="hasAnchor">
<a href="#transformations" class="anchor"></a>Transformations</h4>
<ul>
<li>Log transformation to improve normality.<br>
</li>
<li>Can also help with non-constant variance (heterogenous variance)</li>
<li>log transform is common in regression, and perhaps anova</li>
<li>for some reason people rarely transform t-tests</li>
</ul>
<p>We can wrap our y variable wing.score in log()</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m.H0.log &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(wing.score) <span class="op">~</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">data =</span> student1.F)
m.Ha.log &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(wing.score) <span class="op">~</span><span class="st"> </span>E.or.C, 
               <span class="dt">data =</span> student1.F)</code></pre></div>
<div id="look-at-p-value-for-transformed-data" class="section level5">
<h5 class="hasAnchor">
<a href="#look-at-p-value-for-transformed-data" class="anchor"></a>Look at p-value for transformed data</h5>
<ul>
<li>P-value is actually lower (not always the case)</li>
<li>Note that log transformation makes subtle changes to how hypotheses are formulated / results interpreted</li>
<li>I am not good at explaining this; some people make a big deal about it; others don’t</li>
<li>will provide references</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#raw data</span>
<span class="kw">anova</span>(m.H0, 
      m.Ha)
<span class="co">#&gt; Analysis of Variance Table</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model 1: wing.score ~ 1</span>
<span class="co">#&gt; Model 2: wing.score ~ E.or.C</span>
<span class="co">#&gt;   Res.Df   RSS Df Sum of Sq      F   Pr(&gt;F)    </span>
<span class="co">#&gt; 1     23 14.00                                 </span>
<span class="co">#&gt; 2     22  7.25  1      6.75 20.483 0.000167 ***</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>

<span class="co">#transformed data</span>
<span class="kw">anova</span>(m.H0.log, 
      m.Ha.log)
<span class="co">#&gt; Analysis of Variance Table</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model 1: log(wing.score) ~ 1</span>
<span class="co">#&gt; Model 2: log(wing.score) ~ E.or.C</span>
<span class="co">#&gt;   Res.Df     RSS Df Sum of Sq      F    Pr(&gt;F)    </span>
<span class="co">#&gt; 1     23 0.85251                                  </span>
<span class="co">#&gt; 2     22 0.38241  1    0.4701 27.045 3.247e-05 ***</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></code></pre></div>
</div>
<div id="look-at-residuals" class="section level5">
<h5 class="hasAnchor">
<a href="#look-at-residuals" class="anchor"></a>Look at residuals</h5>
<div id="histogram-of-residuals-for-log-transformation" class="section level6">
<h6>Histogram of residuals for log transformation</h6>
<p>Not much better…</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(<span class="kw">resid</span>(m.Ha.log))</code></pre></div>
<p><img src="f1-analysis_walkthrough_t_test_and_friends_files/figure-html/unnamed-chunk-27-1.png" width="700"></p>
</div>
<div id="qqplot-of-residuals-for-log-transformation" class="section level6">
<h6>qqplot of residuals for log transformation</h6>
<p>More informative that histogram of the residuals; dots should fall on the line…</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(m.Ha.log,  <span class="dv">2</span>)</code></pre></div>
<p><img src="f1-analysis_walkthrough_t_test_and_friends_files/figure-html/unnamed-chunk-28-1.png" width="700"></p>
</div>
</div>
<div id="look-at-heteroskedasticity" class="section level5">
<h5 class="hasAnchor">
<a href="#look-at-heteroskedasticity" class="anchor"></a>Look at heteroskedasticity</h5>
<ul>
<li>Plot residuals versus group</li>
<li>Variance still bad…</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># column with group variables</span>
<span class="kw">summary</span>(student1.F<span class="op">$</span>E.or.C)
<span class="co">#&gt;  C  E </span>
<span class="co">#&gt; 16  8</span>

<span class="co">#    residuls of model       column with group var</span>
<span class="kw">plot</span>(<span class="kw">resid</span>(m.Ha.log)    <span class="op">~</span><span class="st">    </span>student1.F<span class="op">$</span>E.or.C)</code></pre></div>
<p><img src="f1-analysis_walkthrough_t_test_and_friends_files/figure-html/unnamed-chunk-29-1.png" width="700"></p>
</div>
</div>
</div>
<div id="analysis-non-parametric-methods" class="section level3">
<h3 class="hasAnchor">
<a href="#analysis-non-parametric-methods" class="anchor"></a>Analysis Non parametric methods</h3>
<ul>
<li>These data are inherently ordina (ordered categories)</li>
<li>Can be thought of as ranks, allowing for ties, with a minimum rank of 1 and a max of 8</li>
<li>Wilcoxon test is the appropriate non-parametic test for ordinal data (also called Mann-Whiteny or Wilcox-Mann-Whitney)</li>
<li>Related terms: Wilcoxon sign-rank test, Mann-Whitney U-test</li>
<li>In the past many people would transform numeric data into ranks if it was highly skewed or otherwise non-normal<br>
</li>
<li>This causes a LOT of loss of information and usually reduces statistical power to detect differences between groups when they exist</li>
<li>These data, however, are indeed ordinal/ranks so there is no loss of information content by transformation</li>
<li>A Wilcox test is argueably more appropriate, but people debate this (or are stuck in their ways of doing things)</li>
</ul>
<p>Run the test</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">wilcox.test</span>(wing.score <span class="op">~</span><span class="st"> </span>E.or.C, 
            <span class="dt">data =</span> student1.F)
<span class="co">#&gt; Warning in wilcox.test.default(x = c(4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, :</span>
<span class="co">#&gt; cannot compute exact p-value with ties</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Wilcoxon rank sum test with continuity correction</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  wing.score by E.or.C</span>
<span class="co">#&gt; W = 117, p-value = 0.0003917</span>
<span class="co">#&gt; alternative hypothesis: true location shift is not equal to 0</span></code></pre></div>
<p>You might see an error “cannot compute exact p-value with ties.” The computation of the p-values depend on whether there are ties or not in the data; I doubt this is an issue ever in pratice.</p>
<p>Compare p-values: both are very small. The t-test p-value is a bit smaller. Often when you use a test and violate some of its assumptions, your p-values are too big.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">wilcox.test</span>(wing.score <span class="op">~</span><span class="st"> </span>E.or.C, 
            <span class="dt">data =</span> student1.F,
            <span class="dt">exact =</span> F)<span class="op">$</span>p.value
<span class="co">#&gt; [1] 0.0003916797</span>
<span class="kw">t.test</span>(wing.score <span class="op">~</span><span class="st"> </span>E.or.C, 
            <span class="dt">data =</span> student1.F)<span class="op">$</span>p.value
<span class="co">#&gt; [1] 8.976852e-05</span></code></pre></div>
<div id="wilcox-test-normality-and-skew" class="section level4">
<h4 class="hasAnchor">
<a href="#wilcox-test-normality-and-skew" class="anchor"></a>Wilcox test, normality, and skew</h4>
<ul>
<li>Am just learning about this</li>
<li>Wilcox test does fine with non-normal data…</li>
<li>…except, as I understand it when there is high skew</li>
<li>Wilcox test also doesn’t accomodate non-constant variance</li>
<li>Improved Wilcox test:brunner.munzel.test()</li>
</ul>
<p>Seperate out each group into seperate object</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">S1.F.E &lt;-<span class="st"> </span>student1.F <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(E.or.C <span class="op">==</span><span class="st"> "E"</span>)
S1.F.C &lt;-<span class="st"> </span>student1.F <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(E.or.C <span class="op">==</span><span class="st"> "C"</span>)</code></pre></div>
<p>run test</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">brunner.munzel.test</span>(<span class="dt">x =</span> S1.F.E<span class="op">$</span>wing.score,
                    <span class="dt">y =</span> S1.F.C<span class="op">$</span>wing.score)
<span class="co">#&gt; </span>
<span class="co">#&gt;  Brunner-Munzel Test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  S1.F.E$wing.score and S1.F.C$wing.score</span>
<span class="co">#&gt; Brunner-Munzel Test Statistic = 7.1127, df = 8.0062, p-value =</span>
<span class="co">#&gt; 0.0001003</span>
<span class="co">#&gt; 95 percent confidence interval:</span>
<span class="co">#&gt;  0.7798382 1.0482868</span>
<span class="co">#&gt; sample estimates:</span>
<span class="co">#&gt; P(X&lt;Y)+.5*P(X=Y) </span>
<span class="co">#&gt;        0.9140625</span></code></pre></div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li><a href="#preliminaries">Preliminaries</a></li>
      <li><a href="#cleaning-and-subsetting-the-wing-data">Cleaning and subsetting the wing data</a></li>
      <li><a href="#data-analysis">Data analysis</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by First Last.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  
</body>
</html>
